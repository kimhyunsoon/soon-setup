## 환경변수
env = GTK_IM_MODULE,kime
env = QT_IM_MODULE,kime
env = QT4_IM_MODULE,kime
env = XMODIFIERS,@im=kime
env = XCURSOR_SIZE,32
# firefox용
env = MOZ_ENABLE_WAYLAND,1
env = MOZ_WEBRENDER,1
env = MOZ_DRM_DEVICE,/dev/dri/renderD128
# t14s용 (amd gpu)
env = LIBVA_DRIVER_NAME,radeonsi
env = VDPAU_DRIVER,radeonsi
env = AMD_VULKAN_ICD,RADV

## 디스플레이
# 내장
monitor=eDP-1,2880x1800@60,960x333,1
# 외장1
monitor=DP-1,3840x2160@60,3840x333,1
# 외장2
monitor=HDMI-A-1,3840x2160@60,7680x0,1,transform,1,bitdepth,8,vrr,0
# 클램쉘
bindl = , switch:on:Lid Switch, exec, bash -c 'if [[ $(hyprctl monitors | grep -c "^Monitor") == 1 ]]; then systemctl suspend; else hyprctl keyword monitor "eDP-1,disable" && sleep 0.5 && ~/.config/hypr/scripts/monitor-manager.sh; fi'
bindl = , switch:off:Lid Switch, exec, hyprctl keyword monitor "eDP-1,2880x1800@60,960x333,1" && sleep 0.5 && ~/.config/hypr/scripts/monitor-manager.sh

# 모니터별 워크스페이스 할당 (동적, 우선순위)
# 1-3: eDP-1 > DP-1 > HDMI-A-1
workspace = 1, monitor:eDP-1, default:true
workspace = 2, monitor:eDP-1
workspace = 3, monitor:eDP-1
# 4-6: DP-1 > eDP-1 > HDMI-A-1
workspace = 4, monitor:DP-1, default:true
workspace = 5, monitor:DP-1
workspace = 6, monitor:DP-1
# 7-9: HDMI-A-1 > eDP-1 > DP-1
workspace = 7, monitor:HDMI-A-1, default:true
workspace = 8, monitor:HDMI-A-1
workspace = 9, monitor:HDMI-A-1

# XWayland scaling
xwayland {
  force_zero_scaling = true
}

# Bottles로 실행한 카카오톡 창 관리
# maximize/fullscreen 이벤트 무시 (타일링 깨짐 방지)
windowrulev2 = suppressevent maximize, class:steam_proton, title:^.+$
windowrulev2 = suppressevent fullscreen, class:steam_proton, title:^.+$
windowrulev2 = nomaxsize, class:steam_proton, title:^.+$
windowrulev2 = tile, class:steam_proton, title:^.+$
# 그림자 창 숨김
windowrulev2 = noinitialfocus, title:^(KakaoTalkShadowWnd)$
windowrulev2 = workspace special silent, title:^(KakaoTalkShadowWnd)$

# Playwright test 창 관리
windowrulev2 = nomaxsize, class:Chromium-browser
windowrulev2 = tile, class:Chromium-browser

# xfreerdp 창 관리
windowrulev2 = suppressevent maximize, class:^(xfreerdp)$
windowrulev2 = suppressevent fullscreen, class:^(xfreerdp)$
windowrulev2 = nomaxsize, class:^(xfreerdp)$
windowrulev2 = tile, class:^(xfreerdp)$

## 기본 설정
decoration {
  rounding = 0
  active_opacity = 1.0
  inactive_opacity = 0.7
  blur {
    enabled = false
  }
  shadow {
    enabled = false
  }
}

cursor {
  no_hardware_cursors = false
  enable_hyprcursor = true
}

general {
  border_size = 2
  col.active_border = rgba(000000ff)
  col.inactive_border = rgba(000000ff)
  # 창 간격
  gaps_in = 0
  gaps_out = 0
  # 창 크기조절 (마우스)
  resize_on_border = true
  extend_border_grab_area = 15
  # 드래그 관련 설정
  allow_tearing = false
  no_border_on_floating = false
}

input {
  follow_mouse = 0
  # 터치패드 설정
  touchpad {
    # 터치로 클릭 안함
    tap-to-click = false,
    # 1점: 클릭, 2점: 우클릭
    clickfinger_behavior = true
  }
}

gestures {
  # 터치패드 3점 스와이프로 작업공간 전환
  gesture = 3, horizontal, workspace
}

# MX Vertical 감도 조절
device {
  name = logitech-mx-vertical-advanced-ergonomic-mouse
  sensitivity = 0.3
}

# t14s 터치패드 감도 조절
device {
  name = elan0676:00-04f3:3195-touchpad
  sensitivity = 0.3
}

misc {
  disable_splash_rendering = true
  disable_hyprland_logo = true
  vfr = true
  vrr = 1
  disable_autoreload = true
  disable_hyprland_logo = true
  always_follow_on_dnd = true
  layers_hog_keyboard_focus = false
  animate_manual_resizes = false
  enable_swallow = false
  focus_on_activate = true
  mouse_move_enables_dpms = false
  key_press_enables_dpms = false
}

## 애니메이션
animations {
  enabled = true

  bezier = fade, 0.3, 0.0, 0.3, 1.0
  bezier = quart, 0.25, 0.46, 0.45, 0.94

  # 창 열고 닫기
  animation = windows,     1, 2, quart
  # 창 등장
  animation = windowsIn,   1, 2, quart, popin 60%
  # 창 닫기
  animation = windowsOut,  1, 2, quart, popin 100%
  # 창 이동
  animation = windowsMove, 1, 2, quart

  # 워크스페이스
  animation = workspaces,  1, 3, quart, slidefade 30%
  animation = fade,        1, 2, fade
}

# rofi 애니메이션 제외
layerrule = noanim, ^(rofi)$

## 시작 앱
# 배경화면
exec-once = hyprpaper
# 시스템 알림
exec-once = dunst
# 한글 입력기
exec-once = kime
# 네트워크 매니저
exec-once = nm-applet --indicator
# 클립보드 히스토리
exec-once = rm -f ~/.cache/cliphist/db && wl-paste --type text --watch cliphist store & wl-paste --type image --watch cliphist store
# 앱 별 키 바인딩
exec-once = keyd-application-mapper -d
# HDMI 모니터 안정화
exec-once = sleep 2 && hyprctl keyword monitor "HDMI-A-1, disable" && sleep 1 && hyprctl keyword monitor "HDMI-A-1,3840x2160@60,7680x0,1,transform,1,bitdepth,8,vrr,0"
# 모니터/워크스페이스/waybar
exec-once = sleep 4 && ~/.config/hypr/scripts/monitor-manager.sh --daemon
exec = ~/.config/hypr/scripts/monitor-manager.sh

## 시스템 단축키
# 절전
bind = SUPER CONTROL, L, exec, systemctl suspend
# hyprland 새로고침
bind = SUPER CONTROL, R, exec, hyprctl reload
# 스크린샷
bind = SUPER, A, exec, hyprshot -m region -o ~/Downloads/screenshots
# ocr
bind = SUPER, S, exec, bash -ic ocr
# 컬러피커
bind = SUPER, D, exec, hyprpicker -a -n
# 클립보드 히스토리
bind = CONTROL SHIFT, V, exec, cliphist list | rofi -dmenu -theme-str 'element { children: [ element-text ]; }' | cliphist decode | wl-copy
# 앱 종료
bind = CONTROL SHIFT, Q, killactive

## 앱 단축키
# 앱 런처
bind = CONTROL, SPACE, exec, rofi -modi "launcher:~/.config/rofi/rofi.sh" -show launcher -show-icons -no-lazy-grab
# 파일 관리자
bind = ALT, F, exec, thunar
# ghostty
bind = ALT, T, exec, ghostty
# firefox
bind = ALT, W, exec, firefox %
# slack
bind = ALT, S, exec, slack
# thunderbird
bind = ALT, E, exec, thunderbird
# beekeeper
bind = ALT, B, exec, beekeeper-studio

## 창 단축키
# ALT+드래그로 창 이동
bindm = ALT, mouse:272, movewindow
# 워크스페이스 이동
bind = SUPER, bracketleft, exec, bash -c 'WORKSPACE=$(hyprctl activeworkspace -j | jq -r ".id"); if [[ $WORKSPACE -le 1 ]]; then hyprctl dispatch workspace 9; else hyprctl dispatch workspace $(($WORKSPACE - 1)); fi'
bind = SUPER, bracketright, exec, bash -c 'WORKSPACE=$(hyprctl activeworkspace -j | jq -r ".id"); if [[ $WORKSPACE -ge 9 ]]; then hyprctl dispatch workspace 1; else hyprctl dispatch workspace $(($WORKSPACE + 1)); fi'

# 창 focus 이동
bind = CONTROL, left, movefocus, l
bind = CONTROL, right, movefocus, r
bind = CONTROL, up, movefocus, u
bind = CONTROL, down, movefocus, d
# 창 이동
bind = SUPER, left, movewindow, l
bind = SUPER, right, movewindow, r
bind = SUPER, up, movewindow, u
bind = SUPER, down, movewindow, d
# 워크스페이스 간 창 이동
bind = SUPER CONTROL, bracketleft, exec, bash -c 'WORKSPACE=$(hyprctl activewindow -j | jq -r ".workspace.id"); if [[ $WORKSPACE -le 1 ]]; then TARGET=9; else TARGET=$(($WORKSPACE - 1)); fi; hyprctl dispatch movetoworkspacesilent $TARGET; hyprctl dispatch workspace $TARGET'
bind = SUPER CONTROL, bracketright, exec, bash -c 'WORKSPACE=$(hyprctl activewindow -j | jq -r ".workspace.id"); if [[ $WORKSPACE -ge 9 ]]; then TARGET=1; else TARGET=$(($WORKSPACE + 1)); fi; hyprctl dispatch movetoworkspacesilent $TARGET; hyprctl dispatch workspace $TARGET'

## 노트북 기능키
# 음량 조절
bind = , XF86AudioRaiseVolume, exec, pamixer -i 5
bind = , XF86AudioLowerVolume, exec, pamixer -d 5
bind = , XF86AudioMute, exec, pamixer -t
# 밝기 조절
bind = , XF86MonBrightnessUp, exec, brightnessctl set +5%
bind = , XF86MonBrightnessDown, exec, brightnessctl set 5%-
# 미디어 컨트롤
bind = , XF86AudioPlay, exec, playerctl play-pause
bind = , XF86AudioNext, exec, playerctl next
bind = , XF86AudioPrev, exec, playerctl previous
